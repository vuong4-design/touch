from dataclasses import dataclass
from typing import Any, Dict, Tuple


@dataclass
class GuardResult:
    ok: bool
    reason: str = ""


class GuardEvaluator:
    def evaluate(self, guard_type: str, params: Dict[str, Any]) -> GuardResult:
        if guard_type == "always":
            return GuardResult(ok=True)
        if guard_type == "never":
            return GuardResult(ok=False, reason="guard_never")
        return GuardResult(ok=False, reason=f"unsupported_guard:{guard_type}")

    def evaluate_step(self, guards: Tuple[Dict[str, Any], ...]) -> GuardResult:
        for guard in guards:
            result = self.evaluate(guard.get("type", ""), guard.get("params", {}))
            if not result.ok:
                return result
        return GuardResult(ok=True)
